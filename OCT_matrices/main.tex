\documentclass{ximera}
\input{../preamble.tex}

\title{Octave for Chapter 4} \license{CC BY-NC-SA 4.0}

\begin{document}

\begin{abstract}
\end{abstract}
\maketitle

\section*{Octave for Chapter 4}
The templates in this section provide sample Octave code for matrix operations and $LU$-factorization. You can access our code through the link at the bottom of each template.  Feel free to modify the code and experiment to learn more!  

You can write your own code using Octave software or online Octave cells.  To access Octave cells online, go to the \href{https://sagecell.sagemath.org/}{Sage Math Cell Webpage}, select OCTAVE as the language, enter your code, and press EVALUATE.  

To ''save" or share your online code, click on the \emph{Share} button, select \emph{Permalink}, then copy the address directly from the browser window.  You can store this link to access your work later or share this link with others.  You will need to get a new Permalink every time you modify the code.

\subsection*{Octave Tutorial}
\subsubsection*{Basic Operations}

\begin{template}\label{temp:matrixOps}

    \begin{verbatim}
        % Define matrices A, B, and C
        A = [1 -1 0 0;
            2 -2 1 2;
            0 1 0 1];
            
        B = [2 3 -1 4;
            1 -1 2 -2;
            1 -2 0 3];   
            
        C = [1 -2 1 4;
            2 -2 0 1;
            -2 1 1 0;
            1 3 -2 -1];     
            
        % Find A+B
        sum=A+B
        
        % Find the transpose of A
        % Copying and pasting A'  may not work because the prime comes through
        % in a different font.
        A_trans1=A'
        % we can also use the transpose function
        A_trans2=transpose(A)
        
        % Find AC
        product=A*C
        
        % Find the inverse of C
        inv_C=inv(C)
    \end{verbatim}
    
    \href{https://sagecell.sagemath.org/?z=eJxdUMGOwiAUvDfpP8zFqLuaFPRmOFCMP2GMIZVmSVYwhe7-vg-0tcqBMDNv3rzHDHvTWmdw1bGzjQmQK9QraHeBKgsJgSPDmqFCtSsLpMOx5mDgA66QZHYacFnUycaxScbtQOc2yTshOBk3p102Pb3qGZkitm-RlDHgrLLXSCxlURHLvSbdZjhYWkV-12UR-qvIj5GOPwax0y7cfDDwLSStfM4ME3Ke6v4NGu2gf4NHT0XvlrZ3TbTejTYuRnEhl5MoSb956_ylb6KQX-pjCOv-TPcYgSRCZyXoXqjlHXo6X7Q=&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.
    \end{template}
    
    \begin{template}\label{temp:id_matrix}
    Sometimes it is useful to generate a commonly used matrix or a vector (e.g. identity matrix, zero vector). 
    
    \begin{verbatim}
        % 5 by 5 identity matrix
        I_5=eye(5)
        
        % 5 by 5 zero matrix
        O_5=zeros(5)
        
        % The zero vector in R^5
        O_col=zeros(5,1)
        
        % Row of zeros
        O_row=zeros(1,5)
        
        % Non-square zero matrix
        O_block=zeros(2,3)
        
        % Matrix filled with 1s
        One_block=ones(2,3)
    \end{verbatim}
    
    \href{https://sagecell.sagemath.org/?z=eJxdzT0OwjAMBeA9Uu7gpRJIYSgoIwdgAKSKGdQfV40IsUgDoZyepk06sHiwv_ecgYRqGIdq0DjlBniUzqoPZ4eb3OOAK7nmjLMsuS9aWsx5NGHRL-rS4UzeWDuyoAwUVxlkTTpZkUddkAdqp0AfjCUfTS5S44nMpn--Sov_vytN9T36rdhFf5zu0CqtsQGvXAd5KDcYA2Rw9j9PMkr_&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.
    \end{template}
    
    \begin{template}\label{temp:randMat}
        When doing computational experiments you might need to create large matrices.  If the type of matrix is irrelevant, you may want to use random matrices.
    
        \begin{verbatim}
            % Generate a random 3 by 3 matrix A with real-number values between 0 and 1
            A=rand(3,3)
            
            % Generate a random 4 by 5 matrix B with integer values between -10 and 25
            B=randi([-10,25],4,5)
        \end{verbatim}
    
    \href{https://sagecell.sagemath.org/?z=eJxtzLEKwjAUheE9kHc4S6GFFGzTjA7t0ocQhxu8aKCJEFNb397U4qTLGX44X4GRA0dKDEKkcLl7aNhXHk8puhU9FpduiExTHWZvOeJJ08wPWE4Lc8AB-YdGiv64CaVWupJCiuKP3W22-drDbruQ-Prr1s0ut0aK4UO78pSjas1ZdcpUb3XOOqE=&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.    
    \end{template}

    \subsubsection*{Using Loops}

    \begin{example}\label{ex:oct_mat_prod_def}
        Implement Definition \ref{def:matrixvectormult} of matrix-vector multiplication in Octave.  Write a routine that computes the product $A\vec{x}$ of a user-defined matrix $A$ and vector $\vec{x}$.

    \begin{explanation}
    We will use the followng outline for our code.
    \begin{itemize}
    \item The user will enter matrix $A$ and vector $\vec{x}$ at the top of the code.    
    \item We will use the \emph{size} command determine the size of the user-defined matrix $A$.  
    \begin{verbatim}
        % Find the size of matrix A
        [m, n] = size(A);  % m is the number of rows, and n is the number of columns of A
    \end{verbatim}
    \item We will utilize the \emph{length} command to find the length of $\vec{x}$.
    \begin{verbatim}
        % Find the length of vector x
        L=length(x);
    \end{verbatim}
    \item We will check that the dimensions of $A$ and $\vec{x}$ are compatable.  If if the number of columns of $A$ doesn't match the number of entries in $\vec{x}$, we will issue a warning. 
    \begin{verbatim}
        if n ~= L  
            warning("Dimensions of A and x are incompatable.");  
        else  
            % insert product code here ... 
        end    
    \end{verbatim}
\end{itemize}

    Here is the complete code.

    \begin{verbatim}
        % User-defined matrix A
        A=[4 -1 6 10 -2;
        3 11 8 -3 4;
        -5 2 14 6 -1;
        3 2 -3 0 7];

        % User-defined vector x
        x=[-2; 4; 8; 2; 3];

        % Find the size of matrix A
        [m,n]=size(A); % m is the number of rows, and n is the number of columns of A

        % Find the length of vector x
        L=length(x);

        if n ~= L
            warning("Dimensions of A and x are incompatable.");
        else
            % if the dimensions are compatable, proceed with the multiplication

            % Initialize the product matrix
            A_x=zeros(m,1);

            % Find the product Ax 
            for i=1:m
                for j=1:n
                    A_x(i)=A_x(i)+A(i,j)*x(j);
                end
            end

            % Print our answer
            A_x

            % Check our answer
            correct_answer=A*x
        end
    \end{verbatim}

    \href{https://sagecell.sagemath.org/?z=eJxlUU1r20AQvQv0H4aAQU6lYNluY2L2IFoChRx6yckEo0hjexztrtldxSKH_vbOaq0oaXTRzLyPGT1N4NGiyWrckcIaZOkMdVDEUSE2S8hy-AH5DLL5Oo4WkOewgmwBS-6y7zCHfMl4lvfg3CMzuH3iLo4mn31fsXLaQBdHndiwG1vAag1cLAb-Paka3AHB0huC3n24ZSNT9ST8PCmma5iABLI9V7XyGY1nG322KZTsob6ClW5aqawvi_-2Naj27uCR8cYHEaZJN-2Pox2b_hXwEEfAz7k0itQ-ufpFEpUlfXHut3dQGgRSlZan0pXPDd5ceRdsLAb5BNjPr65HudeMihRORlfIuZ2Jb_Nc2TaOTg1VpWOBPypY_VbkqGx8ZJ7Gurqt3CW7QCq2nXhDo20i0zx8UNC-ZzCoig4CtuMcSOR3MrTD6MgjNY4u5glNRXh9KxJKj9PrLjn6PQMHVR2avhi2_zGkHOjWcGz2jOb92JHy84DVyxdKpY3hX7UNM1Fcs4Kd_wE4wcc1&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.

    \end{explanation}   
    \end{example}

    \begin{example}\label{ex:vandermonde}
        A \dfn{Vandermonde matrix} of order $n$ is a square matrix of the form 
        $$V=\begin{bmatrix}
    1&x_1&x_1^2&\dots&x_1^{n-1}\\
    1&x_2&x_2^2&\dots&x_2^{n-1}\\
    \vdots&\vdots&\vdots&\ddots&\vdots\\
    1&x_n&x_n^2&\dots&x_n^{n-1}\end{bmatrix}$$
    We will use a \emph{nested} loop to create a $5\times 5$ Vandermonde matrix for $x_1=2, x_2=-1, x_3=5, x_4=-2, x_5=3$.  We recommend that you create this matrix by hand first, then study and run the code.
    
    \begin{verbatim}
    % Define the vector [x_1, ..., x_5]
    w=[2 -1 5 -2 3];
    
    % This nested loop creates a 5x5 Vandermonde matrix
    for i=1:5
        for j=1:5
            V(i,j)=w(i)^(j-1);
        end
    end
    V
    \end{verbatim}
    
    \href{https://sagecell.sagemath.org/?z=eJxFjEEKgzAURPeB3GE2goIKsWRTcdcjFDdiJeiXRjQpMdQcv7Fd9A08GAYmwY1mbQgKbxq9dejCIHKUZZkjDLLn7Gi6CoWARFHh0tecnUlwf-odhnZPE1ZrXxgdKU97vJJBolVmIrfZaGzKOx04m-O_bsRVcobIWZd_PWlTnS9Zc6Q6e6RLIbL6t5GZOPuq_QBP6C9I&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.
    
    %You will see applications of the Vandermonde matrix in Least Squares, and Curve Fitting.
    
    \end{example}    

    \subsubsection*{$LU$-factorization}
    \begin{template}\label{temp:LU}
        We can find $LU$-factorization of a matrix as follows.  
        
        \begin{verbatim}
        % Define matrix A
        A=[2 2 -1 2;
           -1 2 2 1;
           1 2 0 -2;
           1 1 -2 -4];
           
        % Find LU factorization for A   
        [L, U, P] = lu (A)
        % where L is a lower triangular matrix,
        % U is an upper triangular matrix, and
        % P is an appropriate permutation matrix
        
        % Verify that this factorization is correct
        productLU=L*U
        productPA=P*A
        \end{verbatim}
        
        \href{https://sagecell.sagemath.org/?z=eJxtjrFqwzAURXeB_-EugTbYEJtuxYOgdNLgRV1CBmHLjcCRxKtEmn59n-y0UCgC8Y507uPu8GJn5y0uJpH7hKyE7I8dOjQtuudKAOvEp92owAFN90Mtz2ieThtXYodX5ycojdmMKZD7MskFjzkQ5GocVQ1dYzihx5LxIB9L6nq2ZKHgPmCwhKslcCPj3_Ni6F6vLqJeFY8c478O_03FG-6eiZFCZC1ZcOKS01Zo0ytR3DdLbr4hnU3ii3N_u_PDGIjsmCrBy6Y8JqV7tde_OMh-2Mtvdaxh4w==&lang=octave&interacts=eJyLjgUAARUAuQ==}{Link to code}.
        
        \begin{remark}
        \begin{itemize}
        \item Observe that the permutation matrix $P$ is not the identity matrix.  What elementary row operation does multiplication by $P$ induce?
            \item With the last two lines of our code we checked the correctness of our factorization.  Is it true that $PA=LU$?  Interpret the value $-2.77556e-17$ in the product $LU$.  What do you think caused this value to occur?  
        \end{itemize}
            \end{remark}
            
        \end{template}            

\subsection*{Octave Exercises}
\begin{problem}\label{prob_oct_mat5}
    Let $$A=\begin{bmatrix}2 & 6 & -4 & 1 & 1\\
-1 & 0 & 2 & 2 & 4\\
-2 & 1 & 3 & -2 & 1\\
1 & 1 & 0 & 0 & 6\\
-3 & 4 & 1 & -2 & 0\end{bmatrix}, \quad \vec{b}=\begin{bmatrix}-12\\
 6\\
 -2\\
 -7\\
 -8\end{bmatrix}$$
Solve $A\vec{x}=\vec{b}$ in two different ways.  First, use the reduced row-echelon form of $[A|\vec{b}]$, second multiply both sides of the equation by $A^{-1}$.  Verify that both methods produce the same answer.
\end{problem}

\begin{problem}\label{prob_oct_mat1}
Let $A=\begin{bmatrix} 0 & 1\\5 & 3\end{bmatrix}$.  Find $A^{-1}$ in two different ways.  First, use the \emph{inv} function.  Second, find $\text{rref}[A|I]$.
    \begin{hint}
        To allow for an $n\times n$ input matrix, you can use \emph{length} to automatically detect matrix size.
        
        \begin{verbatim}
            M = [A eye(length(A))]  
        \end{verbatim}
    \end{hint}
\end{problem}   

\begin{problem}\label{prob_oct_mat4}
    Generate a $12\times 14$ matrix filled with $3$'s.
\end{problem}

\begin{problem}\label{prob_oct_mat2}
Write a routine that multiplies an $n\times m$ matrix by a vector by computing the linear combination of the columns of the matrix. (See Example \ref{exp:matrixvectormultdef} for reference.)  
\end{problem}

\begin{problem}\label{prob_oct_mat3}
Write a routine that multiplies an $n\times m$ matrix by a vector using the dot product definition of matrix-vector multiplication. (See Definition \ref{def:matrixvectormult}.)
    
\end{problem}

\begin{problem}\label{prob_oct_6}
    Write a routine that multiplies an $n\times m$ matrix by an $m\times k$ matrix.  

    \begin{hint}
        You can use \href{https://en.wikipedia.org/wiki/Matrix_multiplication_algorithm}{this Wikipedia page} for reference.
    \end{hint}    
\end{problem}

\end{document}